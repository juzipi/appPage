$(document).ready(function(){function t(t){var e=$(t).find(".select-01")[0].selectedIndex;return $(t).find(".select-01").parents(".col-2").removeClass("dou"),0!=e?!0:void $(t).find(".select-01").parents(".col-2").addClass("dou")}function e(t){var e=$(t).find(".paln-time").val();return $("#J_t").hasClass("dou")&&$(t).find(".paln-time").parents(".col-2").removeClass("dou"),""!=e?!0:($(t).find(".paln-time").parents(".col-2").addClass("dou"),!1)}function n(t){var e=$(t).find(".paln-time").attr("data-init"),n=$(t).find(".paln-time").html(),a=$(t).find(".select-01")[0].selectedIndex;e!=n&&0!=a&&$("#J_paln").show()}function a(){var t=$(".paln-fangan").find(".font-c-gray").attr("data-init");$(".paln-fangan").find(".font-c-gray").html(t)}function s(t,e,n){t=t.replace(/-/g,"/");var a=new Date(t);if(a=a.valueOf(),"+"==n)a+=24*e*60*60*1e3;else{if("-"!=n)return!1;a-=24*e*60*60*1e3}a=new Date(a);var s=a.getFullYear(),i=a.getMonth()+1,l=a.getDate();9>=i&&(i="0"+i),9>=l&&(l="0"+l);var r=s+"-"+i+"-"+l;return r}FastClick.attach(document.body);var i={imgAuto:function(t){var e=$(t)[0],n=$(t).attr("src"),a=$(".paln-head").width(),s=$(".paln-head").height(),i=a/s;if($(t)[0]){var l="<div class='i-loading'><div><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div></div>";$(t).parent().append(l),$.ajax({url:n,type:"GET",global:!1,beforeSend:function(){},complete:function(){var n=e.naturalWidth,a=e.naturalHeight,s=n/a;$(t).parent().find(".i-loading").remove(),i>s?$(t).css("width","100%"):$(t).css("height","100%"),$(t).show()}})}},heightCenter:function(t){var e=$(window).height(),n=t.height(),a=n/2;e>n?t.css({"margin-top":-a}):(t.css({width:"auto",height:e,position:"relative",top:"auto"}),$(document).find("body").css("overflow","hidden"))}};i.imgAuto("#headImage"),$(document).on("click",".maskblack",function(t){$("#J_imgPopup").hide()});var l=function(t){var e;return function(){return e||(e=t.apply(this,arguments))}},r=function(t){var e=document.querySelector("meta[name=viewport]"),n=document.createElement("div");return n.id="J_imgPopup",n.className="img-popup",e.setAttribute("content","width=device-width"),$(document).find("body").append(n),n},o=l(r);$("[data-popup]").on("click",function(t){var e=$(this).attr("src"),n=o(),a=document.createElement("img");a.src=e,a.id="J_popupImg";var s='<div class="i-loading"><div><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div></div><div class="maskblack"></div>';$(n).html(s),$(n).show(),a.onload=function(){$(n).find(".i-loading").hide(),$(n).append(a),i.heightCenter($("#J_popupImg"))}}),$(document).bind("mousedown touchstart",function(t){var e=$(t.target);"I"==t.target.tagName&&(e="I"==$(t.target).parent()[0].tagName?$(t.target).parent().parent():$(t.target).parent()),e.addClass("hover")}),$(document).bind("mouseup touchend touchmove",function(t){var e=$(t.target);"I"==t.target.tagName&&(e="I"==$(t.target).parent()[0].tagName?$(t.target).parent().parent():$(t.target).parent()),e.removeClass("hover")}),$("#J_showTrue").on("change",".select-01",function(){var t=$(this);n("#J_showTrue");var e=t[0].selectedIndex,a=t.find("option").eq(e).attr("value");0!=e?t.addClass("cur"):t.removeClass("cur"),"PCF"==a?t.before('<span class="tip-lable-tuijian">推荐</span>'):t.parent().find(".tip-lable-tuijian").remove()}),$("#J_showTrue").on("blur",".paln-time",function(){n("#J_showTrue")}),$("#J_showNone").on("change",".select-01",function(){var t=$("#J_showNone").find(".select-01")[0].selectedIndex;0!=t?($("#J_palnNone").show(),$(this).addClass("cur")):$(this).removeClass("cur")}),$(".select-02").on("change",function(){var t=$(this),e=t[0].selectedIndex,n=t.find("option").eq(e).attr("value");0!=e?t.addClass("cur"):t.removeClass("cur"),"PCF"==n?t.before('<span class="tip-lable-tuijian">推荐</span>'):t.parent().find(".tip-lable-tuijian").remove()}),$(".paln-fangan .i-point").on("click",function(){var t=$(this),e=t.parent(),n="electDis"==e.prev().attr("class")?!1:!0,s=e.parent().find("li").length-1,i=e.parent().find("li").length,l=e.index(),r=s==e.index()?!0:!1,o=e.index(),h=e.attr("class");switch(h){case"dis":a(),e.parent().find("li").each(function(t){$(this).hasClass("electDis")||(t>l?$(this).attr("class","select"):$(this).attr("class","dis"))}),e.attr("class","selected"),e.next().attr("class","select").find(".tip-lable-mini").html("未注射"),t.prev().find(".tip-lable-mini").html("将注射"),e.find(".font-c-gray").html("建议下次注射日期:"+d),e.prev().find(".font-c-gray").html("上次注射日期:"+c);break;case"selected":a(),e.parent().find("li").each(function(t){$(this).hasClass("electDis")||t>l&&$(this).attr("class","select")}),e.attr("class","dis").next().attr("class","selected").find(".tip-lable-mini").html("将注射"),t.prev().find(".tip-lable-mini").html("已注射"),e.find(".font-c-gray").html("上次注射日期:"+c),2==o?e.next().find(".font-c-gray").html(p):e.next().find(".font-c-gray").html("建议下次注射日期:"+d);break;case"select":a(),e.parent().find("li").each(function(n){$(this).hasClass("electDis")||(l>n?$(this).attr("class","dis"):$(this).attr("class","select"),e.prev().hasClass("electDis")?(e.attr("class","dis").next().attr("class","selected").find(".tip-lable-mini").html("将注射"),e.find(".font-c-gray").html("上次注射日期:"+c),e.next().find(".font-c-gray").html("建议下次注射日期:"+d)):(e.attr("class","dis").next().attr("class","selected").find(".tip-lable-mini").html("将注射"),e.prev().attr("class","dis").find(".tip-lable-mini").html("已注射"),t.prev().find(".tip-lable-mini").html("已注射"),e.find(".font-c-gray").html("上次注射日期:"+c),2==o?e.next().find(".font-c-gray").html(p):e.next().find(".font-c-gray").html("建议下次注射日期:"+d)))})}}),_yanzheng={getYesNo:function(){return $("#J_selectYesNo .t-right").find("span").first().hasClass("i-selceted")},getSelectVal:function(t){var e=$(t)[0].selectedIndex;return $(t)[0].getElementsByTagName("option")[e].value},getLevel:function(t){var e=$(t).find(".dis").length;return e}},$(".btnSubmit").bind("tap",function(){e("#J_showTrue"),t("#J_showTrue"),t("#J_showNone"),$(".erro-tip-common").show().css("opacity",1),setTimeout("$('.erro-tip-common').animate({opacity: 0},500)",5e3)});var c="2015-02-12",d=s(c,"21","+"),p=s(c,"356","+");$("#SelectLine").on("click","[data-select]",function(){var t=$(this),e=t.hasClass("icon-cross"),n=$("#SelectLine").width()-26;e?$("#SelectLine").find(".i-point-big").animate({left:n},300,function(){t.addClass("cur").siblings().removeClass("cur"),$("#J_showNone").show(),$("#J_showYes").hide()}):$("#SelectLine").find(".i-point-big").animate({left:"28px"},300,function(){t.addClass("cur").siblings().removeClass("cur"),$("#J_showYes").show(),$("#J_showNone").hide()})}),$("[data-select]").change(function(){var t=$(this),e=t[0].selectedIndex;0==e?t.addClass("font-c-gray").removeClass("font-c-base"):(t.removeClass("font-c-gray").addClass("font-c-base"),$("#J_preLeve").show(),$(window).scrollTop($(document).height()))})});